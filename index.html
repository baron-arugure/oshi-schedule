<!DOCTYPE html>
<html lang="ja">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>5期生スケジュール | Weekly Oshi Calendar</title>

</head>

  <style>
    :root {
      --pink-light: #fff0f6;
      --pink-main: #ffc0cb;
      --pink-dark: #ff77aa;
      --font-main: "Yu Gothic", "Hiragino Kaku Gothic ProN", sans-serif;
    }
    body {
      margin: 0;
      padding: 0;
      font-family: var(--font-main);
      background: linear-gradient(to bottom, #fff6f9, #ffeef5);
      color: #333;
    }
    header {
      background: linear-gradient(45deg, var(--pink-dark), var(--pink-main));
      color: white;
      text-align: center;
      padding: 2rem 1rem;
      box-shadow: 0 4px 12px rgba(255, 119, 170, 0.3);
    }
    header h1 {
      margin: 0;
      font-size: 2.4rem;
      letter-spacing: 1px;
    }
    .container {
      max-width: 1100px;
      margin: 2rem auto;
      padding: 0 1rem;
      overflow-x: auto;
    }
    h2 {
      text-align: center;
      font-size: 1.4rem;
      color: #d24074;
      margin-bottom: 1rem;
    }
    table {
      width: 100%;
      border-collapse: collapse;
      border-radius: 18px;
      overflow: hidden;
      background: rgba(255, 255, 255, 0.9);
      backdrop-filter: blur(6px);
      box-shadow: 0 8px 24px rgba(255, 119, 170, 0.15);
      min-width: 720px;
    }
    th, td {
      padding: 1.1em 0.6em;
      text-align: center;
      min-width: 90px;
      font-size: 1rem;
      transition: all 0.2s ease;
    }
    th {
      background: linear-gradient(45deg, #ffe6f0, #ffd8eb);
      color: #d24074;
      font-weight: bold;
      border-bottom: 3px solid var(--pink-dark);
      text-shadow: 0 1px 0 #fff;
      position: sticky;
      top: 0;
      z-index: 3;
    }
    th:first-child,
    td:first-child {
      position: sticky;
      left: 0;
      z-index: 2;
    }

    td:first-child:not(.oshi-row) {
  background: #fff0f5;
}

    td:not(.oshi-row):hover {
      background: #fff0f6;
      transform: scale(1.03);
      z-index: 1;
      position: relative;
      box-shadow: 0 2px 6px rgba(255, 119, 170, 0.1);
    }
    .oshi-row {
      font-weight: bold;
      color: white;
    }
    .green  { background: linear-gradient(90deg, #a8e063, #56ab2f); }
    .blue   { background: linear-gradient(90deg, #56ccf2, #2f80ed); }
    .aqua   { background: linear-gradient(90deg, #76e4f7, #00c9d4); }
    .yellow { background: linear-gradient(90deg, #fddb92, #fce473); color: #222; }
    .red    { background: linear-gradient(90deg, #ff758c, #ff7eb3); }
    .white  { background: #f7f7f7; color: #444; }

    .uncertain {
      background: repeating-linear-gradient(
        45deg,
        #ffeef0,
        #ffeef0 5px,
        #fff7f9 5px,
        #fff7f9 10px
      );
      font-style: italic;
      border: 1px dashed #ff99bb;
      border-radius: 8px;
      color: #d24074;
      font-size: 0.95em;
      padding: 0.3em;
    }

    .button-group {
      display: flex;
      flex-wrap: wrap;
      gap: 1rem;
      justify-content: center;
      margin-bottom: 2rem;
    }
    .link-button {
      display: inline-block;
      color: white;
      padding: 0.8rem 1.5rem;
      border-radius: 999px;
      text-decoration: none;
      font-weight: bold;
      background: rgba(255,255,255,0.2);
      backdrop-filter: blur(10px);
      transition: all 0.2s ease-in-out;
      box-shadow: 0 4px 12px rgba(0,0,0,0.1);
    }
    .link-button.green  { background: linear-gradient(90deg, #a8e063, #56ab2f); }
    .link-button.blue   { background: linear-gradient(90deg, #56ccf2, #2f80ed); }
    .link-button.white  { background: #f1f1f1; color: #444; }
    .link-button.aqua   { background: linear-gradient(90deg, #76e4f7, #00c9d4); }
    .link-button.yellow { background: linear-gradient(90deg, #fddb92, #fce473); color: #222; }
    .link-button.red    { background: linear-gradient(90deg, #ff758c, #ff7eb3); }
    .link-button:hover  {
      transform: translateY(-2px) scale(1.05);
      box-shadow: 0 6px 20px rgba(0,0,0,0.2);
    }

    .twitter-section {
      margin: 2rem 0;
      background: #fff;
      border-radius: 18px;
      box-shadow: 0 4px 16px rgba(255,119,170,0.07);
      padding: 2rem 0.5rem;
      display: flex;
      flex-wrap: wrap;
      justify-content: space-around;
      gap: 2rem;
    }
    .tweet-box {
      flex: 1 1 330px;
      min-width: 310px;
      max-width: 370px;
      background: #f6f9fa;
      border-radius: 16px;
      padding: 1rem;
      margin: 0.5rem;
      box-shadow: 0 2px 8px rgba(33,150,243,0.05);
      text-align: center;
    }
    .tweet-box h2 {
      margin: 0 0 0.5em 0;
      font-size: 1.2em;
      color: #555;
      font-weight: bold;
    }

    footer {
      text-align: center;
      font-size: 0.85rem;
      color: #888;
      margin-top: 3rem;
      padding-bottom: 2rem;
    }

    table {
  margin-bottom: 2.5rem;
}

  </style>
</head>
<body>
  <header>
    <h1>🗓️ 5期生スケジュール | Weekly Oshi Calendar</h1>
  </header>
  <div class="container">
    <h2>📆 今週の推し配信予定</h2>
    <table>
  <thead>
    <tr>
      <th>5期生</th>
      <th>月</th>
      <th>火</th>
      <th>水</th>
      <th>木</th>
      <th>金</th>
      <th>土</th>
      <th>日</th>
    </tr>
  </thead>
  <tbody>
<tr>
  <td class="oshi-row green">翠森アトリ</td>
  <td id="suiMon"></td><td id="suiTue"></td><td id="suiWed"></td><td id="suiThu"></td><td id="suiFri"></td><td id="suiSat"></td><td id="suiSun"></td>
</tr>
<tr>
  <td class="oshi-row blue">雫川なのか</td>
  <td id="sizuMon"></td><td id="sizuTue"></td><td id="sizuWed"></td><td id="sizuThu"></td><td id="sizuFri"></td><td id="sizuSat"></td><td id="sizuSun"></td>
</tr>
<tr>
  <td class="oshi-row white">白熊汰べる</td>
  <td id="siroMon"></td><td id="siroTue"></td><td id="siroWed"></td><td id="siroThu"></td><td id="siroFri"></td><td id="siroSat"></td><td id="siroSun"></td>
</tr>
<tr>
  <td class="oshi-row aqua">もふやまそらら</td>
  <td id="mohuMon"></td><td id="mohuTue"></td><td id="mohuWed"></td><td id="mohuThu"></td><td id="mohuFri"></td><td id="mohuSat"></td><td id="mohuSun"></td>
</tr>
<tr>
  <td class="oshi-row yellow">ちゃまこ</td>
  <td id="chaMon"></td><td id="chaTue"></td><td id="chaWed"></td><td id="chaThu"></td><td id="chaFri"></td><td id="chaSat"></td><td id="chaSun"></td>
</tr>
<tr>
  <td class="oshi-row red">卯夢月めお</td>
  <td id="uyuMon"></td><td id="uyuTue"></td><td id="uyuWed"></td><td id="uyuThu"></td><td id="uyuFri"></td><td id="uyuSat"></td><td id="uyuSun"></td>
</tr>
  </tbody>
  
</table>

<div class="button-group">
  <a href="https://youtube.com/@suimoriatori" target="_blank" class="link-button green">翠森アトリ</a>
  <a href="https://youtube.com/@nanokach" target="_blank" class="link-button blue">雫川なのか</a>
  <a href="https://youtube.com/@shirokumataberu" target="_blank" class="link-button white">白熊汰べる</a>
  <a href="https://youtube.com/@mofuyamasoraravt" target="_blank" class="link-button aqua">もふやまそらら</a>
  <a href="https://youtube.com/@chamakovt" target="_blank" class="link-button yellow">ちゃまこ</a>
  <a href="https://youtube.com/@uyuzukimeo" target="_blank" class="link-button red">卯夢月めお</a>
</div>

<section class="twitter-section">
  <div class="tweet-box">
    <a class="twitter-timeline"
       data-height="500"
       data-theme="light"
       href="https://x.com/SuimoriAtori">
       Tweets by @suimoriatori
    </a>
  </div>
  <div class="tweet-box">
    <a class="twitter-timeline"
       data-height="500"
       data-theme="light"
       href="https://twitter.com/ShizukawaNanoka">
       Tweets by @ShizukawaNanoka
    </a>
  </div>
  <div class="tweet-box">
    <a class="twitter-timeline"
       data-height="500"
       data-theme="light"
       href="https://x.com/beruVT">
       Tweets by @beruVT
    </a>
  </div>
  <div class="tweet-box">
    <a class="twitter-timeline"
       data-height="500"
       data-theme="light"
       href="https://x.com/mofuyamasorara">
       Tweets by @mofuyamasorara
    </a>
  </div>
  <div class="tweet-box">
    <a class="twitter-timeline"
       data-height="500"
       data-theme="light"
       href="https://x.com/chamakoVT">
       Tweets by @chamakoVT
    </a>
  </div>
  <div class="tweet-box">
    <a class="twitter-timeline"
       data-height="500"
       data-theme="light"
       href="https://x.com/uyuzukimeo">
       Tweets by @uyuzukimeo
    </a>
  </div>
</section>

<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<script>
function parseContent(content) {
  if (!content) return "";
  const rules = [
    { word: "雑談", icon: "🗨️" },
    { word: "歌", icon: "🎤" },
    { word: "作業", icon: "🧪" },
    { word: "コラボ", icon: "👥" },
    { word: "ASMR", icon: "💤" },
    { word: "未定", icon: "❓", class: "uncertain" },
    { word: "ゲリラ", icon: "❓", class: "uncertain" },
    { word: "マロ", icon: "🗨️" },
    { word: "ゲーム", icon: "🎮" }
  ];
  const rule = rules.find(r => content.includes(r.word));
  if (rule) {
    const safe = content.replace(/</g, "&lt;").replace(/>/g, "&gt;");
    return `<span class="${rule.class || ''}">${rule.icon} ${safe}</span>`;
  }
  return content;
}
</script>

<!-- そのあとに window.onload の fetch 処理 -->
<script>
  window.onload = function(){
    fetch("https://script.google.com/macros/s/AKfycbyC_efPMSDoPsrvDlXnVuglZkVR1FkbH3PMR617ZyKHiGOXnBuVxA54KdQYssA_QuisDg/exec")
    .then(response => response.json())
    .then(data => {
      console.log("取得したデータ:", data);
      const members = ["sui","sizu","siro","mohu","cha","uyu"];
      const days = ["Mon","Tue","Wed","Thu","Fri","Sat","Sun"];
      for(let menber = 0; menber < members.length; menber++){
        for(let day = 0; day < 7; day++){
          const cellId = members[menber] + days[day];
          const targetCell = document.getElementById(cellId);
          if (targetCell) {
            targetCell.innerHTML = parseContent(data[menber][days[day]] ?? "");
          }
        }
      }
    })
    .catch(error => {
      console.error("エラー:", error);
    });
  }
</script>
  </div>
</body>
</html>
